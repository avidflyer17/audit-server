<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Audit Serveur DW</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  crossorigin="anonymous"
  referrerpolicy="no-referrer" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/scripts/viewer.js?v=3"></script>
  <style>
    :root {
      --bg: #191a24;
      --text: #f8f8f2;
      --heading: #8be9fd;
      --subheading: #50fa7b;
      --block-bg: #282a36;
    }
    .light-theme {
      --bg: #f0f0f0;
      --text: #1c1c1c;
      --heading: #007acc;
      --subheading: #2b8a3e;
      --block-bg: #ffffff;
    }
    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: "Segoe UI", sans-serif;
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }

    h1 {
      font-size: 2rem;
      color: var(--heading);
      margin-bottom: 0.5rem;
    }

    h2 {
      color: var(--subheading);
      margin-top: 2rem;
    }

    .heading-icon {
      margin-right: 0.5rem;
      vertical-align: middle;
    }

    .subtitle {
      font-style: italic;
      margin-bottom: 1.5rem;
      color: #bbb;
    }

    select,
    input[type="date"],
    input[type="text"] {
      background-color: #333;
      color: white;
      padding: 0.4rem;
      border-radius: 5px;
      border: none;
    }

    .light-theme select,
    .light-theme input[type="date"],
    .light-theme input[type="text"] {
      background-color: #ddd;
      color: #000;
    }

    .btn {
      background: #444;
      color: #fff;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn:hover { background: #666; }

    .btn.primary {
      background: var(--heading);
      color: var(--bg);
    }

    .btn.primary:hover { filter: brightness(1.1); }

    .report-card {
      background: var(--block-bg);
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      margin-bottom: 1rem;
      position: relative;
    }

    #btnLatest {
      display: flex;
      align-items: flex-start;
      justify-content: center;
      flex-direction: column;
      font-size: 1rem;
    }

    #btnLatest i { margin-right: 0.5rem; }
    #btnLatest .label { font-weight: bold; }
    #btnLatest .subinfo {
      font-size: 0.8rem;
      opacity: 0.8;
    }

    .report-grid {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    @media (min-width: 601px) {
      .report-grid {
        display: grid;
        grid-template-columns: 1fr auto;
        grid-template-areas:
          "btn day"
          "timeline timeline"
          "status status";
        gap: 0.5rem;
      }
      #btnLatest { grid-area: btn; }
      .timeline-wrapper { grid-area: timeline; }
      #selectorStatus { grid-area: status; }
      .day-control { grid-area: day; justify-self: end; }
    }

    .day-control {
      display: flex;
      border: 1px solid #555;
      border-radius: 6px;
      overflow: hidden;
    }

    .day-control .seg {
      background: transparent;
      color: var(--text);
      padding: 0.5rem 0.8rem;
      border: none;
      cursor: pointer;
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .day-control .seg:hover { background: #333; }
    .day-control .seg:active { background: #444; }
    .day-control .seg.active {
      background: var(--heading);
      color: var(--bg);
    }

    .day-control .seg:focus-visible {
      outline: 2px solid var(--heading);
      outline-offset: -2px;
    }

    .timeline-wrapper {
      overflow-x: auto;
      padding: 0.5rem;
    }

    .timeline { display: flex; gap: 0.5rem; }

    .time-chip {
      background: #444;
      color: var(--text);
      border: none;
      border-radius: 9999px;
      padding: 0.4rem 0.8rem;
      cursor: pointer;
      white-space: nowrap;
    }

    .time-chip:hover { background: #555; }
    .time-chip:active { background: #666; }

    .time-chip.active {
      background: var(--heading);
      color: var(--bg);
    }

    .time-chip:focus-visible {
      outline: 2px solid var(--heading);
      outline-offset: 4px;
    }

    .refresh-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: var(--subheading);
      opacity: 0.5;
      position: absolute;
      top: 10px;
      right: 10px;
    }

    .refresh-dot.active { animation: blink 1s ease-in-out infinite; }

    @keyframes blink {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }

    .update-badge {
      display: none;
      position: absolute;
      top: 10px;
      right: 30px;
      background: var(--heading);
      color: var(--bg);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.7rem;
    }

    .update-badge.show { display: inline-block; }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .visually-muted {
      color: #bbb;
      font-size: 0.8rem;
    }

    input:focus,
    select:focus,
    button:focus {
      outline: 2px solid var(--heading);
      outline-offset: 2px;
    }

    #selectorStatus {
      margin: 0;
    }

    #selectorStatus.error { color: #ff5555; }
    #selectorStatus.empty { color: #bbb; }

    .skeleton {
      height: 1rem;
      background: #444;
      border-radius: 4px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    canvas {
      width: 100% !important;
      max-height: 300px;
    }

    .code-block {
      width: 100%;
      background-color: var(--block-bg);
      color: var(--text);
      padding: 1rem;
      border-radius: 5px;
      font-family: monospace;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-x: auto;
      box-sizing: border-box;
      font-size: 1rem;
    }

    .block-wrapper {
      position: relative;
      margin-bottom: 1.5rem;
    }

    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #444;
      color: #fff;
      border: none;
      padding: 5px 8px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: background 0.3s ease;
    }
    .copy-btn:hover {
      background: #666;
    }

    #themeSwitchWrapper {
      position: fixed;
      top: 1rem;
      right: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .theme-icon {
      color: var(--text);
      font-size: 1.2rem;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 48px;
      height: 24px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #444;
      transition: .4s;
      border-radius: 24px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    .switch input:checked + .slider {
      background-color: #2196F3;
    }
    .switch input:checked + .slider:before {
      transform: translateX(24px);
    }

    @media screen and (max-width: 600px) {
      #themeSwitchWrapper {
        top: 0.5rem;
        right: 0.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }
      .switch {
        width: 40px;
        height: 20px;
      }
      .slider:before {
        height: 14px;
        width: 14px;
      }
      .switch input:checked + .slider:before {
        transform: translateX(20px);
      }
      .report-grid { display: flex; }
    }

    .temp-wrapper {
      margin-top: 1rem;
      font-family: monospace;
      color: var(--text);
    }
    .temp-bar {
      width: 100%;
      max-width: 400px;
      height: 25px;
      background-color: #444;
      border-radius: 12px;
      overflow: hidden;
      margin: 0.5rem auto 0 auto;
    }
    .temp-fill {
      height: 100%;
      width: 0%;
      background-color: green;
      transition: width 0.5s ease, background-color 0.5s ease;
    }
    .badge {
      padding: 4px 10px;
      border-radius: 8px;
      margin-left: 1rem;
      font-weight: bold;
      font-family: monospace;
    }
    .load-header .badge { margin-left: 0; }
    .load-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .green  { background-color: #4caf50; color: white; }
    .orange { background-color: #ff9800; color: black; }
    .red    { background-color: #f44336; color: white; }

    .ip-container {
      font-family: monospace;
      background: var(--block-bg);
      padding: 0.5rem 1rem;
      border-radius: 5px;
      display: inline-block;
      margin-top: 0.5rem;
    }
    .ip-container div {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.2rem;
    }
    .ip-icon {
      font-size: 1.2rem;
    }

    .disk-bar-container {
      width: 100%;
      max-width: 600px;
      margin: auto;
    }
    .disk-bar {
      background: #444;
      border-radius: 8px;
      overflow: hidden;
      margin-top: 4px;
    }
    .disk-bar-fill {
      height: 20px;
      text-align: center;
      font-size: 0.9rem;
      color: #fff;
    }

    .memory-container {
      max-width: 400px;
      margin: auto;
      padding: 1rem 0;
    }
    .ports-legend {
      font-size: 0.9rem;
      margin: 0.5rem 0;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }
    .ports-legend span {
      display: flex;
      align-items: center;
      gap: 0.2rem;
    }
    .risk-dot {
      width: 0.8rem;
      height: 0.8rem;
      border-radius: 50%;
      display: inline-block;
    }
    .risk-dot.low { background: #2ecc71; }
    .risk-dot.medium { background: #f39c12; }
    .risk-dot.high { background: #e74c3c; }
    .ports-toolbar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      align-items: center;
    }
    #portSearch { flex: 1; min-width: 180px; }
    #portSort { background: #333; color: var(--text); border: none; padding: 0.25rem; border-radius: 4px; }
    .port-accordion { border: 1px solid #444; border-radius: 6px; margin-bottom: 0.5rem; overflow: hidden; }
    .port-accordion + .port-accordion { margin-top: 0.5rem; }
    .accordion-header { background: #333; width: 100%; text-align: left; padding: 0.4rem 0.6rem; border: none; color: var(--text); display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
    .accordion-header .count { background:#444; border-radius:6px; padding:2px 8px; font-family:monospace; }
    .accordion-content { display: none; padding:0.4rem; }
    .port-accordion.open > .accordion-content { display:block; }
    .ip-accordion { border:1px solid #444; border-radius:6px; margin:0.3rem 0; overflow:hidden; }
    .ip-accordion.open > .accordion-content { display:block; }
    .ip-accordion .accordion-header { background:#222; }
    .port-line { display:flex; align-items:center; gap:0.5rem; padding:0.2rem 0.3rem; font-size:0.9rem; }
    .port-line .service-name { flex:1; }
    .port-line .port-mono { font-family:monospace; }
    .port-line .badge { margin-left:0.2rem; font-size:0.7rem; padding:0.1rem 0.3rem; }
    .port-line .actions { margin-left:auto; display:flex; align-items:center; gap:0.3rem; }

    .load-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      align-items: center;
    }

    .load-main {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .gauge {
      position: relative;
      width: 180px;
      height: 180px;
      margin: auto;
    }
    .gauge svg { width: 100%; height: 100%; transform: rotate(-90deg); }
    .gauge .bg { fill: none; stroke: #444; stroke-width: 4; }
    .gauge .progress { fill: none; stroke: var(--load-color, #4caf50); stroke-width: 4; stroke-linecap: round; transition: stroke 0.3s; }
    .gauge-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 2rem; font-weight: bold; display: flex; align-items: baseline; }
    .gauge-label {
      text-align: center;
      margin-top: 0.5rem;
      font-size: 1rem;
      line-height: 1.3;
      opacity: 0.8;
    }
    .trend { font-size: 1rem; margin-left: 0.25rem; }

    .load-cards {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      width: 100%;
    }

    .mini-card {
      background: var(--block-bg);
      padding: 0.75rem;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .mini-title { font-size: 0.8rem; opacity: 0.8; }
    .mini-value { font-weight: bold; font-size: 1.3rem; }
    .mini-bar { background: #444; border-radius: 4px; height: 6px; margin-top: 0.25rem; }
    .mini-bar .fill { height: 100%; border-radius: 4px; background: var(--load-color, #4caf50); width: 0%; }
    .mini-trend { font-size: 0.8rem; opacity: 0.8; margin-top: 0.25rem; }
    .mini-card.na { opacity: 0.5; }

    .load-legend {
      margin-top: 0.75rem;
      display: flex;
      justify-content: center;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
      font-size: 0.85rem;
      line-height: 1.2;
    }
    .legend-item { display: flex; align-items: center; gap: 0.25rem; }
    .dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
    .dot.green { background: #4caf50; }
    .dot.orange { background: #ff9800; }
    .dot.red { background: #f44336; }

    .services-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .services-actions {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
    }
    .services-help {
      font-size: 0.9rem;
      color: #bbb;
      margin-top: -0.5rem;
      margin-bottom: 0.5rem;
    }
    #serviceSearch {
      width: 100%;
      margin-bottom: 0.5rem;
    }
    .filter-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    .filter-chip {
      background: #444;
      color: var(--text);
      border: none;
      border-radius: 9999px;
      padding: 0.25rem 0.6rem;
      cursor: pointer;
      font-size: 0.85rem;
    }
    .filter-chip.active {
      background: var(--heading);
      color: var(--bg);
    }
    .services-toolbar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 0.5rem;
    }
    .services-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 0.5rem;
    }
    .service-item {
      background: var(--block-bg);
      padding: 0.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .service-item:focus-visible {
      outline: 2px solid var(--heading);
      outline-offset: 2px;
    }
    .service-main {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .service-icon {
      width: 1.5rem;
      text-align: center;
    }
    .service-name {
      font-weight: bold;
    }
    .service-badge {
      margin-left: auto;
      padding: 0.1rem 0.4rem;
      border-radius: 4px;
      font-size: 0.75rem;
      background: #555;
    }
    .service-details {
      display: none;
      margin-top: 0.5rem;
      font-size: 0.85rem;
    }
    .service-item.expanded .service-details {
      display: block;
    }
    .copy-btn.small {
      font-size: 0.8rem;
      padding: 0.2rem;
      margin-left: 0.3rem;
    }
    .service-skeleton {
      height: 2rem;
      border-radius: 6px;
    }
    .empty {
      text-align: center;
      padding: 1rem 0;
      color: #bbb;
    }
    .empty.hidden { display: none; }
    .service-badge.cat-systeme { background: #6c757d; }
    .service-badge.cat-reseau { background: #0d6efd; }
    .service-badge.cat-stockage-partages { background: #6f42c1; }
    .service-badge.cat-conteneurs { background: #198754; }
    .service-badge.cat-securite { background: #d63384; }
    .service-badge.cat-journalisation { background: #fd7e14; }
    .service-badge.cat-mises-a-jour { background: #20c997; }
    .service-badge.cat-autre { background: #adb5bd; }

    /* Top processus */
    .top-grid { display: flex; flex-direction: column; gap: 1rem; }
    @media (min-width: 900px) {
      .top-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    }
    .proc-list { display: flex; flex-direction: column; gap: 0.5rem; }
    .proc-row { display: flex; align-items: center; gap: 0.5rem; padding: 0.25rem; border-radius: 6px; cursor: default; }
    @media (max-width: 899px) { .proc-row { flex-wrap: wrap; } }
    .proc-row:hover { background: #333; }
    .proc-row:focus-visible { outline: 2px solid var(--heading); outline-offset: 2px; }
    .proc-icon { width: 1.5rem; text-align: center; flex: 0 0 1.5rem; }
    .proc-name { font-weight: bold; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; min-width: 0; }
    .proc-bars { display: flex; gap: 8px; flex: 1; }
    .bar {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 16px;
      border-radius: 6px;
      overflow: hidden;
      background-color: var(--bar-bg, #333);
    }
    .bar .fill {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 0;
      border-radius: 6px;
      transition: width 250ms ease;
    }
    .bar .value {
      position: relative;
      z-index: 1;
      color: #fff;
      font-size: 0.75rem;
      font-weight: 600;
      white-space: nowrap;
    }
    .fill.green { background: #4caf50; }
    .fill.orange { background: #ff9800; }
    .fill.red { background: #f44336; }
    .fill.blue { background: #2196f3; }
    .fill.yellow { background: #ffeb3b; color: #000; }
    @media (min-width: 900px) {
      .proc-name { flex: 0 0 12rem; }
    }
    @media (max-width: 899px) {
      .proc-bars { flex: 1 0 100%; }
    }
    .total-summary {
      margin-top: 8px;
      padding-top: 6px;
      border-top: 1px solid rgba(255,255,255,0.1);
      font-weight: 600;
      font-size: 0.9rem;
      text-align: right;
      color: var(--accent-color, #4cafef);
    }
    .badge-total {
      background-color: var(--accent-color, #4cafef);
      color: #fff;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.85rem;
    }
    @media (max-width: 899px) {
      .total-summary {
        text-align: center;
        max-width: 90%;
        margin-left: auto;
        margin-right: auto;
      }
    }
    @media (min-width: 900px) {
      .total-summary {
        font-size: 1rem;
      }
    }

    /* Docker */
    .docker-toolbar { display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 0.5rem; align-items: center; }
    .docker-toolbar input { flex: 1; }
    .chips { display: flex; flex-wrap: wrap; gap: 0.5rem; }
    .chip { background: #444; border: none; border-radius: 9999px; padding: 0.25rem 0.6rem; cursor: pointer; color: var(--text); }
    .chip.active { background: var(--heading); color: var(--bg); }
    .docker-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px,1fr)); gap: 0.5rem; }
    .docker-card { background: var(--block-bg); padding: 0.75rem; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: transform 0.2s ease; }
    .docker-card:hover { transform: translateY(-2px); }
    .docker-card:focus-within { outline: 2px solid var(--heading); outline-offset: 2px; }
    .docker-head { display: flex; align-items: center; justify-content: space-between; }
    .docker-title { display: flex; align-items: center; gap: 0.5rem; }
    .docker-name { font-weight: bold; }
    .status-badge { padding: 2px 6px; border-radius: 6px; font-size: 0.75rem; }
    .status-healthy { background: #4caf50; color: #fff; }
    .status-starting { background: #ff9800; color: #000; }
    .status-unhealthy { background: #f44336; color: #fff; }
    .status-exited { background: #777; color: #fff; }
    .status-running { background: #4caf50; color: #fff; }
    .docker-uptime { font-size: 0.8rem; opacity: 0.8; margin-top: 0.25rem; }
    .docker-bars { margin-top: 0.5rem; display: flex; flex-direction: column; gap: 0.25rem; }
    .bar-outer { height: 8px; background: #444; border-radius: 4px; overflow: hidden; }
    .bar-outer .fill { height: 100%; width: 0; transition: width 0.3s ease; }
    .ram-text { font-size: 0.75rem; text-align: right; }

    @media (max-width: 600px) {
      .services-grid { grid-template-columns: 1fr; }
      .services-toolbar { justify-content: flex-start; }
      .filter-chips { position: sticky; top: 0; background: var(--bg); padding-top: 0.5rem; }
    }

    .gauge:focus-visible,
    .mini-card:focus-visible { outline: 2px solid var(--heading); outline-offset: 4px; }

    @media (min-width: 900px) {
      .load-container { flex-direction: row; align-items: center; }
      .load-cards { flex: none; width: 200px; }
    }

    @media (max-width: 600px) {
      .load-container { align-items: stretch; }
      .gauge { width: 160px; height: 160px; }
      .load-header { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
    }

    @media screen and (max-width: 600px) {
      body {
        padding: 1rem;
      }
      h1 {
        font-size: 1.5rem;
      }
      h2 {
        font-size: 1.2rem;
        margin-top: 1.5rem;
      }
      .code-block {
        font-size: 0.9rem;
        padding: 0.75rem;
      }
    }
  </style>
</head>
<body>

  <div id="themeSwitchWrapper">
    <i id="themeIcon" class="fas fa-moon theme-icon"></i>
    <label class="switch">
      <input type="checkbox" id="themeToggle">
      <span class="slider"></span>
    </label>
  </div>

  <h1>🧠 Audit Serveur DW</h1>
  <p class="subtitle">Machine : <strong id="hostname">-</strong></p>

  <div id="reportCard" class="report-card">
    <div class="card-header">
      <h2>Rapports</h2>
      <p class="subtitle">Choisissez un moment</p>
    </div>

    <div class="report-grid">
      <button id="btnLatest" class="btn primary">
        <span><i class="fa-solid fa-bolt"></i></span>
        <span class="label">Voir le dernier rapport</span>
        <small id="latestInfo" class="subinfo"></small>
      </button>

      <div class="timeline-wrapper">
        <div id="timeTimeline" class="timeline" aria-live="polite"></div>
      </div>

      <div id="selectorStatus" aria-live="polite"></div>

      <div class="day-control" role="group" aria-label="Choisir un jour">
        <button id="dayToday" class="seg">Aujourd'hui</button>
        <button id="dayYesterday" class="seg">Hier</button>
        <button id="dayCalendar" class="seg" aria-label="Choisir une date" title="Choisir une date"><i class="fa-solid fa-calendar"></i></button>
        <input type="date" id="datePicker" class="sr-only" />
      </div>
    </div>

    <span id="refreshDot" class="refresh-dot" aria-label="Actualisation automatique" title="Actualisation automatique"></span>
    <span id="updateBadge" class="update-badge">Mis à jour</span>
  </div>

  <h2><i class="fa-solid fa-calendar-day heading-icon"></i>Date de génération</h2>
  <p id="generated">--</p>

  <h2><i class="fa-solid fa-clock heading-icon"></i>Temps de fonctionnement</h2>
  <p id="uptime">--</p>

  <div class="load-header">
    <h2><i class="fa-solid fa-gauge-high heading-icon"></i>Charge moyenne</h2>
    <span id="loadAvgBadge" class="badge" aria-live="polite"></span>
  </div>
  <div id="loadAvg" class="load-container">
    <div class="load-main">
      <div id="loadGauge" class="gauge" title="Charge CPU moyenne sur 1 min" tabindex="0">
        <svg viewBox="0 0 36 36">
          <path class="bg" d="M18 2a16 16 0 1 1 0 32 16 16 0 1 1 0-32"/>
          <path id="loadGaugePath" class="progress" d="M18 2a16 16 0 1 1 0 32 16 16 0 1 1 0-32" stroke-dasharray="0 100"/>
        </svg>
        <div class="gauge-value"><span id="load1Val">--</span><span id="loadTrend" class="trend">→</span></div>
      </div>
      <div class="gauge-label">charge sur 1 min</div>
      <div class="load-legend">
        <span class="legend-item"><span class="dot green"></span> Faible</span>
        <span class="legend-item"><span class="dot orange"></span> Élevée</span>
        <span class="legend-item"><span class="dot red"></span> Critique</span>
      </div>
    </div>
    <div class="load-cards">
      <div id="load5Card" class="mini-card" title="Charge moyenne sur 5 min" tabindex="0">
        <div class="mini-title">5 min</div>
        <div id="load5Val" class="mini-value">--</div>
        <div class="mini-bar"><div id="load5Bar" class="fill"></div></div>
        <div id="load5Trend" class="mini-trend">--</div>
      </div>
      <div id="load15Card" class="mini-card" title="Charge moyenne sur 15 min" tabindex="0">
        <div class="mini-title">15 min</div>
        <div id="load15Val" class="mini-value">--</div>
        <div class="mini-bar"><div id="load15Bar" class="fill"></div></div>
        <div id="load15Trend" class="mini-trend">--</div>
      </div>
    </div>
  </div>

  <h2><i class="fa-solid fa-network-wired heading-icon"></i>Adressage réseau</h2>
  <div id="ipInfo" class="ip-container">
    <div><span class="ip-icon">📡</span> IP Locale : <span id="ipLocal">--</span></div>
    <div><span class="ip-icon">🌐</span> IP Externe : <span id="ipPublic">--</span></div>
  </div>

  <h2><i class="fa-solid fa-microchip heading-icon"></i>Utilisation CPU par cœur <span id="cpuLoadBadge" class="badge">--</span></h2>
  <canvas id="cpuChart"></canvas>

  <h2><i class="fa-solid fa-temperature-three-quarters heading-icon"></i>Températures CPU</h2>
  <div id="tempsContainer"></div>

  <h2><i class="fa-solid fa-memory heading-icon"></i>Mémoire RAM</h2>
  <div class="memory-container">
    <canvas id="memoryChart"></canvas>
  </div>

  <h2><i class="fa-solid fa-hard-drive heading-icon"></i>Disques</h2>
  <div id="disksContainer" class="disk-bar-container"></div>

    <div class="services-title-row">
      <h2><i class="fa-solid fa-list-check heading-icon"></i>Services actifs</h2>
      <div class="services-actions">
        <span id="servicesCount">0 service</span>
      </div>
    </div>
  <p class="services-help">Survolez un service pour voir sa description.</p>
  <div class="block-wrapper">
    <input type="text" id="serviceSearch" placeholder="Filtrer un service… ex. ssh" />
    <div id="categoryFilters" class="filter-chips"></div>
    <div class="services-toolbar">
      <select id="serviceSort">
        <option value="az">A→Z</option>
        <option value="za">Z→A</option>
        <option value="cat">Par catégorie</option>
      </select>
    </div>
    <div id="servicesList" class="services-grid">
      <div class="service-skeleton skeleton"></div>
      <div class="service-skeleton skeleton"></div>
      <div class="service-skeleton skeleton"></div>
    </div>
    <div id="servicesEmpty" class="empty hidden">
      Aucun service ne correspond au filtre.
      <button id="resetFilters" class="btn">Réinitialiser les filtres</button>
    </div>
  </div>

  <h2><i class="fa-solid fa-plug heading-icon"></i>Ports ouverts <span id="portsTotal" class="badge">0</span></h2>
  <p class="subtitle">Interfaces et services détectés</p>
  <div id="portsLegend" class="ports-legend"></div>
  <div class="ports-toolbar">
    <input type="text" id="portSearch" placeholder="Filtrer… ex. 22, ssh, 0.0.0.0" />
    <div id="portFilters" class="filter-chips"></div>
    <select id="portSort">
      <option value="port-asc">Port ↑</option>
      <option value="port-desc">Port ↓</option>
      <option value="service">Service A→Z</option>
      <option value="risk">Risque</option>
    </select>
  </div>
  <div id="portsContainer" class="block-wrapper"></div>
  <div id="portsEmpty" class="empty hidden">Aucun port ne correspond. <button id="portsReset" class="btn">Réinitialiser</button></div>

  <div class="top-grid">
    <div class="top-panel">
      <h2><i class="fa-solid fa-fire heading-icon"></i>Top 5 processus - CPU</h2>
      <div id="topCpu" class="report-card proc-list"></div>
    </div>
    <div class="top-panel">
      <h2><i class="fa-solid fa-memory heading-icon"></i>Top 5 processus - RAM</h2>
      <div id="topMem" class="report-card proc-list"></div>
    </div>
  </div>

  <h2><i class="fa-brands fa-docker heading-icon"></i>Conteneurs Docker</h2>
  <div class="docker-toolbar">
    <input type="text" id="dockerSearch" placeholder="Rechercher un conteneur…" aria-label="Rechercher un conteneur…">
    <div id="dockerFilters" class="chips">
      <button class="chip active" data-filter="healthy">healthy</button>
      <button class="chip active" data-filter="unhealthy">unhealthy</button>
      <button class="chip active" data-filter="running">running</button>
      <button class="chip active" data-filter="exited">exited</button>
    </div>
    <select id="dockerSort" aria-label="Tri">
      <option value="cpu">CPU</option>
      <option value="ram">RAM</option>
      <option value="name" selected>Nom</option>
    </select>
  </div>
  <div id="dockerGrid" class="docker-grid"></div>
  <div id="dockerEmpty" class="empty hidden">Aucun conteneur actif</div>
  <script>
    const themeSwitch = document.getElementById("themeToggle");
    const themeIcon = document.getElementById("themeIcon");
    function applyTheme(t){
      document.body.classList.toggle("light-theme", t === "light");
      themeSwitch.checked = t === "light";
      if (themeIcon) themeIcon.className = t === "light" ? "fas fa-sun theme-icon" : "fas fa-moon theme-icon";
    }
    themeSwitch.addEventListener("change", () => {
      const next = themeSwitch.checked ? "light" : "dark";
      localStorage.setItem("theme", next);
      applyTheme(next);
    });
    applyTheme(localStorage.getItem("theme") || "dark");
  </script>

</body>
</html>
